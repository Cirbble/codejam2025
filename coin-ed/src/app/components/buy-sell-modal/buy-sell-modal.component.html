@if (isOpen()) {
  <div class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ agentType() === 'buyer' ? 'AI Buyer' : 'AI Seller' }} Agent</h2>
        <button class="close-btn" (click)="closeModal()">Ã—</button>
      </div>

      <div class="modal-body">
        @if (!showSuccess()) {
          <p class="instruction">{{ agentType() === 'buyer' ? 'AI Buyer' : 'AI Seller' }} agent will execute a {{ agentType() === 'buyer' ? 'buy' : 'sell' }} order:</p>
          
          @if (generatedMessage()) {
            <div class="message-container">
              <div class="message-header">
                <span class="message-icon">ðŸ¤–</span>
                <span class="message-title">Agent Message</span>
              </div>
              <div class="message-content">
                {{ generatedMessage() }}
              </div>
            </div>
          }
        }

        @if (showSuccess()) {
          <div class="success-container">
            <div class="success-title">{{ selectedAction() === 'buy' ? 'Successfully bought!' : 'Successfully sold!' }}</div>
            <div class="currencies-list">
              <div class="currencies-label">Currencies:</div>
              <div class="currencies-items">
                @for (currency of currencies(); track currency) {
                  <span class="currency-badge">{{ currency }}</span>
                }
              </div>
            </div>
          </div>
        }
      </div>

      <div class="modal-footer">
        @if (!showSuccess()) {
          @if (selectedAction()) {
            <button class="confirm-btn" (click)="confirmAction()">
              Confirm {{ selectedAction() === 'buy' ? 'Buy' : 'Sell' }} Action
            </button>
          }
          <button class="cancel-btn" (click)="closeModal()">Cancel</button>
        }
      </div>
    </div>
  </div>
}
